
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../math/discrete%20math/">
      
      
        <link rel="next" href="../../../Animation/animation/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.18">
    
    
      
        <title>Datestructure - Cool Spy's Site</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-structure" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Cool Spy&#39;s Site" class="md-header__button md-logo" aria-label="Cool Spy's Site" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cool Spy's Site
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Datestructure
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Cool Spy&#39;s Site" class="md-nav__button md-logo" aria-label="Cool Spy's Site" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Cool Spy's Site
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../home/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Study
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Study
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Maths
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Maths
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear%20algebra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear Algebra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/mathematics%20analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mathematics Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/discrete%20math/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discrete Mathematics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Computer Science
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Computer Science
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Datestructure
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Datestructure
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#graph" class="md-nav__link">
    <span class="md-ellipsis">
      Graph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dfs-and-its-application" class="md-nav__link">
    <span class="md-ellipsis">
      DFS and its application
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DFS and its application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#topological-sort" class="md-nav__link">
    <span class="md-ellipsis">
      Topological Sort
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#circle-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Circle detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strongly-connected-components-computation" class="md-nav__link">
    <span class="md-ellipsis">
      Strongly Connected components computation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Strongly Connected components computation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tarjan" class="md-nav__link">
    <span class="md-ellipsis">
      Tarjan算法的主要思想
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      算法步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      伪代码
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    <span class="md-ellipsis">
      C语言实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      解释
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kosaraju-sharir" class="md-nav__link">
    <span class="md-ellipsis">
      Kosaraju-Sharir算法步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      算法伪代码
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c_1" class="md-nav__link">
    <span class="md-ellipsis">
      C语言实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      解释
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Animation/animation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Animation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#graph" class="md-nav__link">
    <span class="md-ellipsis">
      Graph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dfs-and-its-application" class="md-nav__link">
    <span class="md-ellipsis">
      DFS and its application
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DFS and its application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#topological-sort" class="md-nav__link">
    <span class="md-ellipsis">
      Topological Sort
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#circle-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Circle detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strongly-connected-components-computation" class="md-nav__link">
    <span class="md-ellipsis">
      Strongly Connected components computation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Strongly Connected components computation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tarjan" class="md-nav__link">
    <span class="md-ellipsis">
      Tarjan算法的主要思想
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      算法步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      伪代码
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    <span class="md-ellipsis">
      C语言实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      解释
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kosaraju-sharir" class="md-nav__link">
    <span class="md-ellipsis">
      Kosaraju-Sharir算法步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      算法伪代码
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c_1" class="md-nav__link">
    <span class="md-ellipsis">
      C语言实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      解释
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="data-structure">Data structure</h1>
<h2 id="graph">Graph</h2>
<p>!!! Overall <em>Introduction</em>: The graph is powerful tool to handle many practical problems, especially the routine management ones, like crossing the river. There are may algorithms, both referred to in the data structure course and discrete mathematics courses. The theory and the relative proofs are indeed important, which verifies the validity of these algorithms. However, as for my current situation, I think the most urgent thing is to know how to implement the in code.  </p>
<h3 id="dfs-and-its-application">DFS and its application</h3>
<p>DFS is used to traverse the graph, each vertex only once, and it will give a spanning tree if we record the edges throughout the whole process.</p>
<p>Here is the general code:
The graph here is a UDAG(undirected acyclic) and unweighted.</p>
<pre><code class="language-C">void DFS(int G[][], int v, int Nv, int visited[] ){
    visited[v]=1;
    for(int i=0; i&lt;Nv; i++){
        if( G[v][i]&amp;&amp;!visited[i] ){
            DFS(G, i, Nv, visited);
        }
    }
}
</code></pre>
<h4 id="topological-sort">Topological Sort</h4>
<p>The graph is a DAG, unweighted and connected.</p>
<pre><code class="language-C">int top=0;
void DFS(int a[][], int v, int Nv, int visited[], int stack){
    visited[v]=true;
    for(int i=0;i&lt;Nv;i++){
        if(a[v][i]&amp;&amp;!visited[i]){
            DFS(a, i, Nv, visited);
        }
    }
    stack[top++]=v;
}
void topologcial_sort(int G[][], int Nv){
    int stack[Nv];
    int visited[Nv];
    for(int i=0;i&lt;Nv;i++){
        visited[i]=0;
    }
    DFS(G, 0, Nv, visited, stack);
    while(top&gt;-1){
        printf(&quot;%d &quot;,stack[top--]);
    }
}
</code></pre>
<h4 id="circle-detection">Circle detection</h4>
<h4 id="strongly-connected-components-computation">Strongly Connected components computation</h4>
<p>Tarjan算法是用来在有向图中寻找强连通分量（Strongly Connected Components, SCC）的经典算法。强连通分量是指一个有向图中的一个最大子图，其中每一对顶点都可以互相到达。Tarjan算法是基于深度优先搜索（DFS）的，并且可以在线性时间内完成（O(V + E)）。</p>
<h5 id="tarjan">Tarjan算法的主要思想</h5>
<p>Tarjan算法使用一个栈和一些辅助数组来记录顶点的访问状态。在DFS的过程中，每个顶点都被分配了一个唯一的编号（DFS编号）和一个最低可达编号（Low-link值）。通过这些编号，可以判断顶点是否属于同一个强连通分量。</p>
<h5 id="_1">算法步骤</h5>
<ol>
<li><strong>初始化</strong>：设置DFS编号、Low-link值等辅助数组，并初始化栈。</li>
<li><strong>DFS遍历</strong>：对每个未访问的顶点执行DFS，递归地访问所有可达的顶点。</li>
<li><strong>更新Low-link值</strong>：在DFS过程中更新当前顶点和其后继顶点的Low-link值。</li>
<li><strong>识别强连通分量</strong>：当发现一个顶点的DFS编号和Low-link值相等时，它是一个强连通分量的根节点，将栈中所有到达该顶点的顶点弹出，形成一个强连通分量。</li>
</ol>
<h5 id="_2">伪代码</h5>
<p>下面是Tarjan算法的伪代码：</p>
<pre><code class="language-pseudo">// n 是图中的顶点数
index = 0
stack = []
indices = [-1] * n
lowlink = [0] * n
onStack = [False] * n
SCCs = []

function strongconnect(v):
    indices[v] = index
    lowlink[v] = index
    index += 1
    stack.push(v)
    onStack[v] = True

    // 考虑 v 的每个后继顶点 w
    for each (v, w) in edges:
        if indices[w] == -1:
            // w 还未访问过，递归访问它
            strongconnect(w)
            lowlink[v] = min(lowlink[v], lowlink[w])
        else if onStack[w]:
            // w 在栈中，是一个回边
            lowlink[v] = min(lowlink[v], indices[w])

    // 如果 v 是一个强连通分量的根节点
    if lowlink[v] == indices[v]:
        SCC = []
        while True:
            w = stack.pop()
            onStack[w] = False
            SCC.append(w)
            if w == v:
                break
        SCCs.append(SCC)

for each v in vertices:
    if indices[v] == -1:
        strongconnect(v)

return SCCs
</code></pre>
<h5 id="c">C语言实现</h5>
<p>下面是Tarjan算法在C语言中的实现：</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdbool.h&gt;

#define MAX 100

int index = 0, n;
int indices[MAX], lowlink[MAX];
bool onStack[MAX];
int stack[MAX], stackTop = -1;
int graph[MAX][MAX];
int SCC[MAX][MAX], SCCIndex = 0, SCCSizes[MAX];

void push(int v) {
    stack[++stackTop] = v;
    onStack[v] = true;
}

int pop() {
    int v = stack[stackTop--];
    onStack[v] = false;
    return v;
}

void strongconnect(int v) {
    indices[v] = lowlink[v] = index++;
    push(v);

    for (int w = 0; w &lt; n; w++) {
        if (graph[v][w]) {
            if (indices[w] == -1) {
                strongconnect(w);
                lowlink[v] = lowlink[v] &lt; lowlink[w] ? lowlink[v] : lowlink[w];
            } else if (onStack[w]) {
                lowlink[v] = lowlink[v] &lt; indices[w] ? lowlink[v] : indices[w];
            }
        }
    }

    if (lowlink[v] == indices[v]) {
        int w;
        do {
            w = pop();
            SCC[SCCIndex][SCCSizes[SCCIndex]++] = w;
        } while (w != v);
        SCCIndex++;
    }
}

void tarjan() {
    for (int i = 0; i &lt; n; i++) {
        indices[i] = -1;
        lowlink[i] = 0;
        onStack[i] = false;
    }

    for (int i = 0; i &lt; n; i++) {
        if (indices[i] == -1) {
            strongconnect(i);
        }
    }
}

int main() {
    printf(&quot;Enter the number of vertices: &quot;);
    scanf(&quot;%d&quot;, &amp;n);

    printf(&quot;Enter the adjacency matrix:\n&quot;);
    for (int i = 0; i &lt; n; i++) {
        for (int j = 0; j &lt; n; j++) {
            scanf(&quot;%d&quot;, &amp;graph[i][j]);
        }
    }

    tarjan();

    printf(&quot;Strongly Connected Components:\n&quot;);
    for (int i = 0; i &lt; SCCIndex; i++) {
        printf(&quot;SCC %d: &quot;, i + 1);
        for (int j = 0; j &lt; SCCSizes[i]; j++) {
            printf(&quot;%d &quot;, SCC[i][j]);
        }
        printf(&quot;\n&quot;);
    }

    return 0;
}
</code></pre>
<h5 id="_3">解释</h5>
<ol>
<li><strong>初始化</strong>：设置DFS编号数组<code>indices</code>和Low-link值数组<code>lowlink</code>，初始化栈和相关标记。</li>
<li><strong>递归函数 <code>strongconnect</code></strong>：执行DFS，更新Low-link值，并在发现强连通分量时，将栈中相关顶点弹出，形成强连通分量。</li>
<li><strong>主函数 <code>tarjan</code></strong>：对每个未访问的顶点调用递归函数<code>strongconnect</code>。</li>
<li><strong>输入输出</strong>：在<code>main</code>函数中读取顶点数量和邻接矩阵，调用<code>tarjan</code>算法，输出找到的强连通分量。</li>
</ol>
<p>Kosaraju-Sharir算法是一种用于在有向图中寻找强连通分量（Strongly Connected Components, SCC）的经典算法。该算法基于两次深度优先搜索（DFS），其时间复杂度为O(V + E)，其中V是顶点数，E是边数。</p>
<h5 id="kosaraju-sharir">Kosaraju-Sharir算法步骤</h5>
<ol>
<li><strong>反转图</strong>：首先反转图中的所有边，得到一个新的图。</li>
<li><strong>第一次DFS</strong>：对原图进行深度优先搜索，记录每个顶点的完成时间。</li>
<li><strong>第二次DFS</strong>：按照第一次DFS的完成时间的逆序对反转图进行深度优先搜索，找到所有的强连通分量。</li>
</ol>
<h5 id="_4">算法伪代码</h5>
<pre><code class="language-pseudo">function kosarajuSharir(G):
    let G_rev be the reverse of graph G
    let S be an empty stack
    let visited be a map from node to boolean

    // First DFS: Record the finish time of each node
    function dfs1(v):
        visited[v] = true
        for each neighbor w of v in G:
            if not visited[w]:
                dfs1(w)
        S.push(v)

    // Second DFS: Collect nodes in the same SCC
    function dfs2(v, component):
        visited[v] = true
        component.add(v)
        for each neighbor w of v in G_rev:
            if not visited[w]:
                dfs2(w, component)

    // Initialize the visited map and run the first DFS
    for each vertex v in G:
        visited[v] = false
    for each vertex v in G:
        if not visited[v]:
            dfs1(v)

    // Reinitialize the visited map for the second DFS
    for each vertex v in G:
        visited[v] = false

    // Process all nodes in the order defined by the stack S
    let SCCs be an empty list of components
    while S is not empty:
        v = S.pop()
        if not visited[v]:
            let component be an empty list
            dfs2(v, component)
            SCCs.append(component)

    return SCCs
</code></pre>
<h5 id="c_1">C语言实现</h5>
<p>以下是Kosaraju-Sharir算法的C语言实现：</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdbool.h&gt;

#define MAX 100

int graph[MAX][MAX];
int graph_rev[MAX][MAX];
bool visited[MAX];
int stack[MAX];
int stackTop = -1;
int SCC[MAX][MAX], SCCIndex = 0, SCCSizes[MAX];
int n;

void push(int v) {
    stack[++stackTop] = v;
}

int pop() {
    return stack[stackTop--];
}

void dfs1(int v) {
    visited[v] = true;
    for (int w = 0; w &lt; n; w++) {
        if (graph[v][w] &amp;&amp; !visited[w]) {
            dfs1(w);
        }
    }
    push(v);
}

void dfs2(int v) {
    visited[v] = true;
    SCC[SCCIndex][SCCSizes[SCCIndex]++] = v;
    for (int w = 0; w &lt; n; w++) {
        if (graph_rev[v][w] &amp;&amp; !visited[w]) {
            dfs2(w);
        }
    }
}

void kosarajuSharir() {
    // Step 1: Run DFS on the original graph to fill the stack
    for (int i = 0; i &lt; n; i++) {
        visited[i] = false;
    }
    for (int i = 0; i &lt; n; i++) {
        if (!visited[i]) {
            dfs1(i);
        }
    }

    // Step 2: Reverse the graph
    for (int i = 0; i &lt; n; i++) {
        for (int j = 0; j &lt; n; j++) {
            graph_rev[i][j] = graph[j][i];
        }
    }

    // Step 3: Run DFS on the reversed graph in the order defined by the stack
    for (int i = 0; i &lt; n; i++) {
        visited[i] = false;
    }
    while (stackTop != -1) {
        int v = pop();
        if (!visited[v]) {
            SCCSizes[SCCIndex] = 0;
            dfs2(v);
            SCCIndex++;
        }
    }
}

int main() {
    printf(&quot;Enter the number of vertices: &quot;);
    scanf(&quot;%d&quot;, &amp;n);

    printf(&quot;Enter the adjacency matrix:\n&quot;);
    for (int i = 0; i &lt; n; i++) {
        for (int j = 0; j &lt; n; j++) {
            scanf(&quot;%d&quot;, &amp;graph[i][j]);
        }
    }

    kosarajuSharir();

    printf(&quot;Strongly Connected Components:\n&quot;);
    for (int i = 0; i &lt; SCCIndex; i++) {
        printf(&quot;SCC %d: &quot;, i + 1);
        for (int j = 0; j &lt; SCCSizes[i]; j++) {
            printf(&quot;%d &quot;, SCC[i][j]);
        }
        printf(&quot;\n&quot;);
    }

    return 0;
}
</code></pre>
<h5 id="_5">解释</h5>
<ol>
<li><strong>初始化和输入</strong>：读取顶点数量和邻接矩阵，初始化相关数组和变量。</li>
<li><strong>第一次DFS</strong>：对原图执行DFS，按照完成时间将顶点压入栈中。</li>
<li><strong>图反转</strong>：生成反转图，将图中的每条边方向反转。</li>
<li><strong>第二次DFS</strong>：按照第一次DFS的完成时间的逆序对反转图执行DFS，找到所有的强连通分量。</li>
<li><strong>输出结果</strong>：输出所有的强连通分量。</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
    
  </body>
</html>